{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "b91dca11-00cb-4757-92d3-8651120b8146",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "✅ Convertido: deliveries.csv\n",
      "✅ Convertido: stores.csv\n",
      "✅ Convertido: orders.csv\n",
      "✅ Convertido: drivers.csv\n",
      "✅ Convertido: hubs.csv\n",
      "✅ Convertido: payments.csv\n",
      "✅ Convertido: channels.csv\n"
     ]
    }
   ],
   "source": [
    "import os\n",
    "import pandas as pd\n",
    "\n",
    "raw_folder = '../data/raw/'\n",
    "\n",
    "# Listar todos os arquivos e padronizar em 'utf-8'\n",
    "for file in os.listdir(raw_folder):\n",
    "    if file.endswith('.csv'):\n",
    "        file_path = os.path.join(raw_folder, file)\n",
    "        try:\n",
    "            df = pd.read_csv(file_path, encoding='latin1')\n",
    "            df.to_csv(file_path, index=False, encoding='utf-8')\n",
    "            print(f\"✅ Convertido: {file}\")\n",
    "        except Exception as e:\n",
    "            print(f\"❌ Erro ao processar {file}: {e}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "e08e2f99-64a3-4ed7-b89c-4e5668476d5f",
   "metadata": {},
   "outputs": [],
   "source": [
    "df = pd.read_csv(\"../data/raw/channels.csv\")\n",
    "df = df.to_csv('../data/raw/channels.csv', index=False)\n",
    "\n",
    "df = pd.read_csv(\"../data/raw/deliveries.csv\")\n",
    "df = df.to_csv('../data/raw/deliveries.csv', index=False)\n",
    "\n",
    "df = pd.read_csv(\"../data/raw/drivers.csv\")\n",
    "df = df.to_csv('../data/raw/drivers.csv', index=False)\n",
    "\n",
    "df = pd.read_csv(\"../data/raw/hubs.csv\")\n",
    "df = df.to_csv('../data/raw/hubs.csv', index=False)\n",
    "\n",
    "df = pd.read_csv(\"../data/raw/orders.csv\")\n",
    "df = df.to_csv('../data/raw/orders.csv', index=False)\n",
    "\n",
    "df = pd.read_csv(\"../data/raw/payments.csv\")\n",
    "df = df.to_csv('../data/raw/payments.csv', index=False)\n",
    "\n",
    "df = pd.read_csv(\"../data/raw/stores.csv\")\n",
    "df = df.to_csv('../data/raw/stores.csv', index=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "b04e9a63-dbed-4436-9311-102c5f82897b",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "\n",
    "# Criação do Dicionário\n",
    "\n",
    "data_dictionary = pd.DataFrame([\n",
    "    # Tabela: channels\n",
    "    {\"variavel\": \"channel_id\", \"descricao\": \"Identificador do canal de venda\", \"tipo\": \"qualitativa\", \"subtipo\": \"nominal\"},\n",
    "    {\"variavel\": \"channel_name\", \"descricao\": \"Nome do canal (ex: App, WhatsApp, etc.)\", \"tipo\": \"qualitativa\", \"subtipo\": \"nominal\"},\n",
    "    {\"variavel\": \"channel_type\", \"descricao\": \"Tipo do canal (Próprio, Marketplace, etc.)\", \"tipo\": \"qualitativa\", \"subtipo\": \"nominal\"},\n",
    "\n",
    "    # Tabela: deliveries\n",
    "    {\"variavel\": \"delivery_id\", \"descricao\": \"Identificador único da entrega\", \"tipo\": \"qualitativa\", \"subtipo\": \"nominal\"},\n",
    "    {\"variavel\": \"delivery_order_id\", \"descricao\": \"ID do pedido relacionado à entrega\", \"tipo\": \"qualitativa\", \"subtipo\": \"nominal\"},\n",
    "    {\"variavel\": \"driver_id\", \"descricao\": \"ID do motorista responsável pela entrega\", \"tipo\": \"qualitativa\", \"subtipo\": \"nominal\"},\n",
    "    {\"variavel\": \"delivery_distance_meters\", \"descricao\": \"Distância total da entrega em metros\", \"tipo\": \"quantitativa\", \"subtipo\": \"contínua\"},\n",
    "    {\"variavel\": \"delivery_status\", \"descricao\": \"Status final da entrega (ex: entregue, cancelada, etc.)\", \"tipo\": \"qualitativa\", \"subtipo\": \"nominal\"},\n",
    "\n",
    "    # Tabela: drivers\n",
    "    {\"variavel\": \"driver_modal\", \"descricao\": \"Modal de transporte do motorista (carro, moto, bike, etc.)\", \"tipo\": \"qualitativa\", \"subtipo\": \"nominal\"},\n",
    "    {\"variavel\": \"driver_type\", \"descricao\": \"Tipo de vínculo com o motorista (CLT, parceiro, etc.)\", \"tipo\": \"qualitativa\", \"subtipo\": \"nominal\"},\n",
    "\n",
    "    # Tabela: hubs\n",
    "    {\"variavel\": \"hub_id\", \"descricao\": \"Identificador do hub logístico\", \"tipo\": \"qualitativa\", \"subtipo\": \"nominal\"},\n",
    "    {\"variavel\": \"hub_name\", \"descricao\": \"Nome do hub logístico\", \"tipo\": \"qualitativa\", \"subtipo\": \"nominal\"},\n",
    "    {\"variavel\": \"hub_city\", \"descricao\": \"Cidade onde o hub está localizado\", \"tipo\": \"qualitativa\", \"subtipo\": \"nominal\"},\n",
    "    {\"variavel\": \"hub_state\", \"descricao\": \"Estado onde o hub está localizado\", \"tipo\": \"qualitativa\", \"subtipo\": \"nominal\"},\n",
    "    {\"variavel\": \"hub_latitude\", \"descricao\": \"Latitude da localização do hub\", \"tipo\": \"quantitativa\", \"subtipo\": \"contínua\"},\n",
    "    {\"variavel\": \"hub_longitude\", \"descricao\": \"Longitude da localização do hub\", \"tipo\": \"quantitativa\", \"subtipo\": \"contínua\"},\n",
    "\n",
    "    # Tabela: orders\n",
    "    {\"variavel\": \"order_id\", \"descricao\": \"Identificador do pedido\", \"tipo\": \"qualitativa\", \"subtipo\": \"nominal\"},\n",
    "    {\"variavel\": \"store_id\", \"descricao\": \"ID da loja responsável pelo pedido\", \"tipo\": \"qualitativa\", \"subtipo\": \"nominal\"},\n",
    "    {\"variavel\": \"channel_id\", \"descricao\": \"ID do canal usado para fazer o pedido\", \"tipo\": \"qualitativa\", \"subtipo\": \"nominal\"},\n",
    "    {\"variavel\": \"payment_order_id\", \"descricao\": \"ID da transação de pagamento associada\", \"tipo\": \"qualitativa\", \"subtipo\": \"nominal\"},\n",
    "    {\"variavel\": \"order_status\", \"descricao\": \"Status do pedido (finalizado, cancelado, etc.)\", \"tipo\": \"qualitativa\", \"subtipo\": \"nominal\"},\n",
    "    {\"variavel\": \"order_amount\", \"descricao\": \"Valor total do pedido\", \"tipo\": \"quantitativa\", \"subtipo\": \"contínua\"},\n",
    "    {\"variavel\": \"order_delivery_fee\", \"descricao\": \"Valor pago de taxa de entrega\", \"tipo\": \"quantitativa\", \"subtipo\": \"contínua\"},\n",
    "    {\"variavel\": \"order_delivery_cost\", \"descricao\": \"Custo real da entrega\", \"tipo\": \"quantitativa\", \"subtipo\": \"contínua\"},\n",
    "    \n",
    "    # Timestamps importantes\n",
    "    {\"variavel\": \"order_moment_created\", \"descricao\": \"Data/hora da criação do pedido\", \"tipo\": \"temporal\", \"subtipo\": \"datetime\"},\n",
    "    {\"variavel\": \"order_moment_accepted\", \"descricao\": \"Data/hora da aceitação do pedido pela loja\", \"tipo\": \"temporal\", \"subtipo\": \"datetime\"},\n",
    "    {\"variavel\": \"order_moment_ready\", \"descricao\": \"Data/hora em que o pedido ficou pronto\", \"tipo\": \"temporal\", \"subtipo\": \"datetime\"},\n",
    "    {\"variavel\": \"order_moment_collected\", \"descricao\": \"Data/hora da coleta do pedido pelo entregador\", \"tipo\": \"temporal\", \"subtipo\": \"datetime\"},\n",
    "    {\"variavel\": \"order_moment_delivered\", \"descricao\": \"Data/hora em que o pedido foi entregue\", \"tipo\": \"temporal\", \"subtipo\": \"datetime\"},\n",
    "    \n",
    "    # Métricas de tempo\n",
    "    {\"variavel\": \"order_metric_cycle_time\", \"descricao\": \"Tempo total do ciclo do pedido (criação até finalização)\", \"tipo\": \"quantitativa\", \"subtipo\": \"contínua\"},\n",
    "    {\"variavel\": \"order_metric_transit_time\", \"descricao\": \"Tempo de trânsito (da coleta até a entrega)\", \"tipo\": \"quantitativa\", \"subtipo\": \"contínua\"},\n",
    "    {\"variavel\": \"order_metric_production_time\", \"descricao\": \"Tempo de produção do pedido\", \"tipo\": \"quantitativa\", \"subtipo\": \"contínua\"},\n",
    "\n",
    "    # Tabela: payments\n",
    "    {\"variavel\": \"payment_id\", \"descricao\": \"ID da transação de pagamento\", \"tipo\": \"qualitativa\", \"subtipo\": \"nominal\"},\n",
    "    {\"variavel\": \"payment_order_id\", \"descricao\": \"ID do pedido associado ao pagamento\", \"tipo\": \"qualitativa\", \"subtipo\": \"nominal\"},\n",
    "    {\"variavel\": \"payment_amount\", \"descricao\": \"Valor pago pelo cliente\", \"tipo\": \"quantitativa\", \"subtipo\": \"contínua\"},\n",
    "    {\"variavel\": \"payment_fee\", \"descricao\": \"Taxa cobrada na transação\", \"tipo\": \"quantitativa\", \"subtipo\": \"contínua\"},\n",
    "    {\"variavel\": \"payment_method\", \"descricao\": \"Método de pagamento utilizado\", \"tipo\": \"qualitativa\", \"subtipo\": \"nominal\"},\n",
    "    {\"variavel\": \"payment_status\", \"descricao\": \"Status do pagamento (aprovado, recusado, etc.)\", \"tipo\": \"qualitativa\", \"subtipo\": \"nominal\"},\n",
    "\n",
    "    # Tabela: stores\n",
    "    {\"variavel\": \"store_id\", \"descricao\": \"ID da loja\", \"tipo\": \"qualitativa\", \"subtipo\": \"nominal\"},\n",
    "    {\"variavel\": \"hub_id\", \"descricao\": \"ID do hub ao qual a loja está associada\", \"tipo\": \"qualitativa\", \"subtipo\": \"nominal\"},\n",
    "    {\"variavel\": \"store_name\", \"descricao\": \"Nome da loja\", \"tipo\": \"qualitativa\", \"subtipo\": \"nominal\"},\n",
    "    {\"variavel\": \"store_segment\", \"descricao\": \"Segmento de atuação da loja\", \"tipo\": \"qualitativa\", \"subtipo\": \"nominal\"},\n",
    "    {\"variavel\": \"store_plan_price\", \"descricao\": \"Valor do plano contratado pela loja\", \"tipo\": \"quantitativa\", \"subtipo\": \"contínua\"},\n",
    "    {\"variavel\": \"store_latitude\", \"descricao\": \"Latitude da loja\", \"tipo\": \"quantitativa\", \"subtipo\": \"contínua\"},\n",
    "    {\"variavel\": \"store_longitude\", \"descricao\": \"Longitude da loja\", \"tipo\": \"quantitativa\", \"subtipo\": \"contínua\"},\n",
    "])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "08d42bf5-8044-40c9-a782-2b3ccd93dc80",
   "metadata": {},
   "outputs": [],
   "source": [
    "#salvar\n",
    "data_dictionary.to_csv(\"../data/external/dicionario.csv\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "72b1afca-8158-4863-b470-ef4b95f0f5a7",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.11"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
